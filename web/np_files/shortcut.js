shortcut={all_shortcuts:{},add:function(shortcut_combination,callback,opt){var default_options={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1};if(opt)for(var dfo in default_options)void 0===opt[dfo]&&(opt[dfo]=default_options[dfo]);else opt=default_options;var ele=opt.target;"string"==typeof opt.target&&(ele=document.getElementById(opt.target));shortcut_combination=shortcut_combination.toLowerCase();var func=function(e){var element;if((e=e||window.event,opt.disable_in_input)&&(e.target?element=e.target:e.srcElement&&(element=e.srcElement),3==element.nodeType&&(element=element.parentNode),"INPUT"==element.tagName||"TEXTAREA"==element.tagName))return;e.keyCode?code=e.keyCode:e.which&&(code=e.which);var character=String.fromCharCode(code).toLowerCase();188==code&&(character=","),190==code&&(character=".");var keys=shortcut_combination.split("+"),kp=0,shift_nums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},special_keys={esc:27,escape:27,tab:9,space:32,return:13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,break:19,insert:45,home:36,delete:46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},modifiers={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};e.ctrlKey&&(modifiers.ctrl.pressed=!0),e.shiftKey&&(modifiers.shift.pressed=!0),e.altKey&&(modifiers.alt.pressed=!0),e.metaKey&&(modifiers.meta.pressed=!0);for(var i=0;k=keys[i],i<keys.length;i++)"ctrl"==k||"control"==k?(kp++,modifiers.ctrl.wanted=!0):"shift"==k?(kp++,modifiers.shift.wanted=!0):"alt"==k?(kp++,modifiers.alt.wanted=!0):"meta"==k?(kp++,modifiers.meta.wanted=!0):1<k.length?special_keys[k]==code&&kp++:opt.keycode?opt.keycode==code&&kp++:character==k?kp++:shift_nums[character]&&e.shiftKey&&(character=shift_nums[character])==k&&kp++;if(kp==keys.length&&modifiers.ctrl.pressed==modifiers.ctrl.wanted&&modifiers.shift.pressed==modifiers.shift.wanted&&modifiers.alt.pressed==modifiers.alt.wanted&&modifiers.meta.pressed==modifiers.meta.wanted&&(callback(e),!opt.propagate))return e.cancelBubble=!0,e.returnValue=!1,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1};this.all_shortcuts[shortcut_combination]={callback:func,target:ele,event:opt.type},ele.addEventListener?ele.addEventListener(opt.type,func,!1):ele.attachEvent?ele.attachEvent("on"+opt.type,func):ele["on"+opt.type]=func},remove:function(shortcut_combination){shortcut_combination=shortcut_combination.toLowerCase();var binding=this.all_shortcuts[shortcut_combination];if(delete this.all_shortcuts[shortcut_combination],binding){var type=binding.event,ele=binding.target,callback=binding.callback;ele.detachEvent?ele.detachEvent("on"+type,callback):ele.removeEventListener?ele.removeEventListener(type,callback,!1):ele["on"+type]=!1}}};